(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{515:function(t,a,s){"use strict";s.r(a);var e=s(4),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[t._v("开发者可以使用 "),s("strong",[t._v("云开发")]),t._v(" 开发微信小程序、小游戏，无需搭建服务器，即可使用云端能力。云开发为开发者提供完整的原生云端支持和微信服务支持，弱化后端和运维概念，无需搭建服务器，使用平台提供的 API 进行核心业务开发，即可实现快速上线和迭代，同时这一能力，同开发者已经使用的云服务相互兼容，并不互斥。")])]),t._v(" "),s("p",[t._v("同事们喜欢玩桌游"),s("code",[t._v("狼人杀")]),t._v("，工作之余就想做一个狼人杀的发牌器，身为前端，考虑到项目上线需要服务器，于是就有了使用云开发小程序的需求。\n上图感受一下～\n"),s("img",{staticClass:"img",attrs:{src:t.$withBase("/images/langrensha.png")}})]),t._v(" "),s("h3",{attrs:{id:"云开发控制台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#云开发控制台"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/console.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("云开发控制台"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("可视化的云资源管理器")]),t._v(" "),s("ul",[s("li",[t._v("概览：查看云资源的总体使用情况")]),t._v(" "),s("li",[t._v("用户管理：查看小程序的用户访问记录")]),t._v(" "),s("li",[t._v("数据库：管理数据库集合、记录、权限设置、索引设置")]),t._v(" "),s("li",[t._v("存储管理：管理云文件、权限设置")]),t._v(" "),s("li",[t._v("云函数：管理云函数、查看调用日志、监控记录")]),t._v(" "),s("li",[t._v("统计分析：查看云资源详细使用统计")])]),t._v(" "),s("h3",{attrs:{id:"初始化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/init.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("初始化"),s("OutboundLink")],1)]),t._v(" "),s("ul",[s("li",[t._v("云 API 的初始化")])]),t._v(" "),s("h3",{attrs:{id:"数据库开发指引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据库开发指引"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/database.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("数据库开发指引"),s("OutboundLink")],1)]),t._v(" "),s("h4",{attrs:{id:"如何上手数据库开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何上手数据库开发"}},[t._v("#")]),t._v(" 如何上手数据库开发")]),t._v(" "),s("p",[t._v("在开始使用数据库 API 进行增删改查操作之前，需要先获取数据库的引用。以下调用获取默认环境的数据库的引用：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" db "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("database")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("如需获取其他环境的数据库引用，可以在调用时传入一个对象参数，在其中通过 "),s("code",[t._v("env")]),t._v(" 字段指定要使用的环境。此时方法会返回一个对测试环境数据库的引用。")]),t._v(" "),s("p",[t._v("示例：假设有一个环境名为 "),s("code",[t._v("test")]),t._v("，用做测试环境，那么可以如下获取测试环境数据库：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" testDB "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("database")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  env"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("要操作一个集合，需先获取它的引用。在获取了数据库的引用后，就可以通过数据库引用上的 "),s("code",[t._v("collection")]),t._v(" 方法获取一个集合的引用了，比如获取待办事项清单集合：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" todos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("collection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'todos'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("获取集合的引用并不会发起网络请求去拉取它的数据，我们可以通过此引用在该集合上进行增删查改的操作，除此之外，还可以通过集合上的 "),s("code",[t._v("doc")]),t._v(" 方法来获取集合中一个指定 ID 的记录的引用。同理，记录的引用可以用于对特定记录进行更新和删除操作。")]),t._v(" "),s("p",[t._v("假设我们有一个待办事项的 ID 为 "),s("code",[t._v("todo-identifiant-aleatoire")]),t._v("，那么我们可以通过 "),s("code",[t._v("doc")]),t._v(" 方法获取它的引用：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" todo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("collection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'todos'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("doc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'todo-identifiant-aleatoire'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"存储开发指引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#存储开发指引"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/storage.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("存储开发指引"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("云存储提供高可用、高稳定、强安全的云端存储服务，支持任意数量和形式的非结构化数据存储，如视频和图片，并在控制台进行可视化管理。云存储包含以下功能：")]),t._v(" "),s("ul",[s("li",[t._v("存储管理：支持文件夹，方便文件归类。支持文件的上传、删除、移动、下载、搜索等，并可以查看文件的详情信息")]),t._v(" "),s("li",[t._v("权限设置：支持基础权限设置和高级安全规则权限控制")]),t._v(" "),s("li",[t._v("上传管理：在这里可以查看文件上传历史、进度及状态")]),t._v(" "),s("li",[t._v("文件搜索：支持文件前缀名称及子目录文件的搜索")]),t._v(" "),s("li",[t._v("组件支持：支持在 image、audio 等组件中传入云文件 ID")])]),t._v(" "),s("h3",{attrs:{id:"云函数开发指引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#云函数开发指引"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/functions.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("云函数开发指引"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("云函数即在云端（服务器端）运行的函数。在物理设计上，一个云函数可由多个文件组成，占用一定量的 CPU 内存等计算资源；各云函数完全独立；可分别部署在不同的地区。开发者无需购买、搭建服务器，只需编写函数代码并部署到云端即可在小程序端调用，同时云函数之间也可互相调用。")]),t._v(" "),s("p",[t._v("一个云函数的写法与一个在本地定义的 JavaScript 方法无异，代码运行在云端 Node.js 中。当云函数被小程序端调用时，定义的代码会被放在 Node.js 运行环境中执行。我们可以如在 Node.js 环境中使用 JavaScript 一样在云函数中进行网络请求等操作，而且我们还可以通过云函数后端 SDK 搭配使用多种服务，比如使用云函数 SDK 中提供的数据库和存储 API 进行数据库和存储的操作，这部分可参考数据库和存储后端 API 文档。")]),t._v(" "),s("p",[t._v("云开发的云函数的独特优势在于与微信登录鉴权的无缝整合。当小程序端调用云函数时，云函数的传入参数中会被注入小程序端用户的 openid，开发者无需校验 openid 的正确性因为微信已经完成了这部分鉴权，开发者可以直接使用该 openid。")]),t._v(" "),s("comment")],1)}),[],!1,null,null,null);a.default=n.exports}}]);